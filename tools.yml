tools:
  - name: host-autoconf
    version: '2.69'
    from_source: autoconf
    configure:
      - args: ['@THIS_SOURCE_DIR@/configure', '--prefix=@PREFIX@']
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install']

  - name: host-automake
    version: '1.16'
    from_source: automake
    tools-required:
      - host-autoconf
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--prefix=@PREFIX@'
    compile:
      - args: ['make', 'bin/aclocal-1.16', 'bin/automake-1.16', '-j@PARALLELISM@']
        environ:
          PATH: '@THIS_COLLECT_DIR@/bin'

      - args: ['make', '-j@PARALLELISM@']
        environ:
          PATH: '@THIS_COLLECT_DIR@/bin'
    install:
      - args: ['make', 'install-strip']
      - args: ['ln', '-sf', '@PREFIX@/share/aclocal-1.16', '@PREFIX@/share/aclocal']
      - args: ['cp', '-r', '@THIS_SOURCE_DIR@/autoconf-archive/m4/.', '@PREFIX@/share/aclocal-1.16/']

  - name: host-libtool
    version: '2.4.6'
    from_source: libtool
    configure:
      - args: ['@THIS_SOURCE_DIR@/configure', '--prefix=@PREFIX@']
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install']

  - name: host-pkg-config
    version: '0.29.2'
    from_source: pkg-config
    configure:
      - args: ['@THIS_SOURCE_DIR@/configure', '--prefix=@PREFIX@', '--with-internal-glib']
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install-strip']

  - name: host-binutils
    version: '2.43'
    from_source: binutils
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--prefix=@PREFIX@'
        - '--target=@TARGET@'
        - '--enable-shared'
        - '--with-sysroot=@SYSROOT_DIR@'
        - '--disable-werror'
        environ:
          CFLAGS: '-O2 -pipe'
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install']

  - name: host-gcc
    version: '13.2.0'
    from_source: gcc
    tools-required:
      - tool: host-binutils
        recursive: true
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--prefix=@PREFIX@'
        - '--target=@TARGET@'
        - '--with-sysroot=@SYSROOT_DIR@'
        - '--disable-nls'
        - '--enable-shared'
        - '--enable-languages=c,c++'
        - '--enable-initfini-array'
        # -g blows up GCC's binary size.
        environ:
          CFLAGS: '-O2 -pipe'
          CXXFLAGS: '-O2 -pipe'
    stages:
      - name: compiler
        pkgs-required:
         - mlibc-headers
        compile:
          - args: ['make', '-j@PARALLELISM@', 'all-gcc']
        install:
          - args: ['make', 'install-gcc']
      - name: libgcc
        tools-required:
          - tool: host-gcc
            stage-dependencies: [compiler]
        pkgs-required:
         - mlibc
        compile:
          - args: ['make', '-j@PARALLELISM@', 'all-target-libgcc']
        install:
          - args: ['make', 'install-target-libgcc']
      - name: libstdc++
        tools-required:
          - tool: host-gcc
            stage-dependencies: [libgcc]
        compile:
          - args: ['make', '-j@PARALLELISM@', 'all-target-libstdc++-v3']
        install:
          - args: ['make', 'install-target-libstdc++-v3']