{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://hades.org/hbuild/package",
    "title": "Package",
    "description": "hbuild package",
    "type": "object",
    "properties": {
        "name": {
            "description": "Package name",
            "type": "string"
        },

        "version": {
            "description": "Package version",
            "type": "string"
        },

        "from_source": {
            "description": "Build it from a preexisting source",
            "type": "string"
        },
        "source": {
            "$ref": "/hbuild/source"
        },

        "debian": {
            "description": "Debian control file information",
            "type": "object",
            "properties": {
                
            }
        },

        "tools-required": {
            "description": "Required tools to build this package",
            "type": "array",
            "items": {
                "oneOf": [
                    { "type": "string" },
                    {
                        "type": "object",
                        "properties": {
                            "stage-dependencies": {
                               "description": "Stage specific dependencies",
                               "type": "array",
                               "items": { "type": "string" },
                               "minItems": 1,
                               "uniqueItems": true
                            }
                       }
                    }
                ]
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "pkgs-required": {
            "description": "Required packages to build this tool",
            "type": "array",
            "items": {
                "type": "string"
            },
            "minItems": 1,
            "uniqueItems": true
        },

        "configure": {
            "description": "Configure step for tool or package",
            "type": "array",
            "items": {
                "$ref": "/hbuild/step"
            },
            "minItems": 1,
            "uniqueItems": true
        },
        "build": {
            "description": "Build step for tool or package",
            "type": "array",
            "items": {
                "$ref": "/hbuild/step"
            },
            "minItems": 1,
            "uniqueItems": true
        },

        "stages": {
            "description": "Package build stages",
            "type": "array",
            "items": {
                "$ref": "/hbuild/stage"
            },
            "minItems": 1,
            "uniqueItems": true
        }
    },

    "required": ["version"],

    "if": { "required": ["from_source"] },
    "then": { "not": { "required": ["source"] } }
}